<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Instagram Login - crespo.world</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body {
      background: #000;
      color: #0f0;
      font-family: monospace;
      text-align: center;
      margin: 0;
      padding: 2em;
    }
    nav {
      margin-bottom: 2em;
    }
    nav a {
      color: #0f0;
      text-decoration: none;
      margin: 0 1em;
      font-weight: bold;
    }
    nav a:hover {
      text-decoration: underline;
    }
    h1 { 
      font-size: 2.5em; 
      margin-bottom: 0.5em; 
      text-shadow: 0 0 10px #0f0;
    }
    .container {
      max-width: 600px;
      margin: 0 auto;
      padding: 2em;
      border: 2px solid #0f0;
      background: #111;
      border-radius: 10px;
    }
    .instagram-gradient {
      background: linear-gradient(45deg, #f09433 0%, #e6683c 25%, #dc2743 50%, #cc2366 75%, #bc1888 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    .login-section {
      margin: 2em 0;
      padding: 2em;
      border: 1px solid #333;
      border-radius: 8px;
      background: #0a0a0a;
    }
    .login-section h3 {
      color: #0f0;
      margin-bottom: 1em;
    }
    input[type="text"], input[type="password"] {
      background: #000;
      color: #0f0;
      border: 2px solid #0f0;
      padding: 0.8em;
      margin: 0.5em 0;
      font-family: monospace;
      font-size: 1em;
      width: 100%;
      max-width: 300px;
      box-sizing: border-box;
    }
    input[type="text"]:focus, input[type="password"]:focus {
      outline: none;
      box-shadow: 0 0 10px #0f0;
    }
    button {
      background: #000;
      color: #0f0;
      border: 2px solid #0f0;
      padding: 0.8em 1.5em;
      margin: 0.5em;
      cursor: pointer;
      font-family: monospace;
      font-size: 1em;
      transition: all 0.3s;
    }
    button:hover {
      background: #0f0;
      color: #000;
      box-shadow: 0 0 15px #0f0;
    }
    .instagram-btn {
      background: linear-gradient(45deg, #f09433, #e6683c, #dc2743, #cc2366, #bc1888);
      color: white;
      border: none;
      padding: 1em 2em;
      font-size: 1.1em;
      font-weight: bold;
      cursor: pointer;
      border-radius: 5px;
      transition: all 0.3s;
    }
    .instagram-btn:hover {
      transform: scale(1.05);
      box-shadow: 0 0 20px rgba(220, 39, 67, 0.5);
    }
    .status-card {
      background: #0a0a0a;
      border: 2px solid #0f0;
      border-radius: 8px;
      padding: 1.5em;
      margin: 1.5em 0;
    }
    .status-connected {
      border-color: #2ecc71;
    }
    .status-disconnected {
      border-color: #e74c3c;
    }
    .status-indicator {
      display: inline-block;
      width: 12px;
      height: 12px;
      border-radius: 50%;
      margin-right: 0.5em;
    }
    .indicator-green {
      background: #2ecc71;
      box-shadow: 0 0 10px #2ecc71;
    }
    .indicator-red {
      background: #e74c3c;
      box-shadow: 0 0 10px #e74c3c;
    }
    .account-list {
      text-align: left;
      margin: 1em 0;
    }
    .account-item {
      padding: 0.8em;
      margin: 0.5em 0;
      border: 1px solid #333;
      border-radius: 5px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .account-item .username {
      color: #0f0;
      font-weight: bold;
    }
    .account-item .expiry {
      color: #ff0;
      font-size: 0.85em;
    }
    .countdown {
      color: #ff0;
      font-size: 1.2em;
      margin: 0.5em 0;
    }
    .info-box {
      background: #1a1a1a;
      border-left: 4px solid #0f0;
      padding: 1em;
      margin: 1em 0;
      text-align: left;
    }
    .warning-box {
      background: #1a1a1a;
      border-left: 4px solid #ff0;
      padding: 1em;
      margin: 1em 0;
      text-align: left;
      color: #ff0;
    }
    .hidden {
      display: none;
    }
    .suggested-accounts {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5em;
      justify-content: center;
      margin: 1em 0;
    }
    .suggested-btn {
      background: #1a1a1a;
      color: #0f0;
      border: 1px solid #0f0;
      padding: 0.5em 1em;
      font-size: 0.9em;
      border-radius: 3px;
    }
    .suggested-btn:hover {
      background: #0f0;
      color: #000;
    }
    .sync-status {
      margin-top: 1em;
      padding: 1em;
      border: 1px dashed #0f0;
      border-radius: 5px;
    }
    .progress-bar {
      width: 100%;
      height: 20px;
      background: #333;
      border-radius: 10px;
      overflow: hidden;
      margin: 0.5em 0;
    }
    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #0f0, #2ecc71);
      transition: width 0.3s;
    }
    a.nav-active {
      text-decoration: underline !important;
      color: #2ecc71 !important;
    }
  </style>
</head>
<body>
  <nav>
    <a href="index.html">home</a>
    <a href="officecam.html">officecam</a>
    <a href="crespomize.html">crespomize</a>
    <a href="recipeasy.html">recipeasy</a>
    <a href="instalogin.html" class="nav-active">instalogin</a>
  </nav>

  <h1>üì∏ <span class="instagram-gradient">Instagram</span> Login</h1>
  
  <div class="container">
    <!-- Info Section -->
    <div class="info-box">
      <strong>üîó Connect Your Instagram Account</strong><br><br>
      This page helps you manage Instagram accounts for the crespomize analytics tracker.<br><br>
      <strong>How it works:</strong>
      <ol style="margin: 0.5em 0; padding-left: 1.5em;">
        <li>Select an account from the MoonMedia list or enter your own</li>
        <li>Click "Connect with Instagram" to authorize access</li>
        <li>You'll be redirected to Instagram's official login page</li>
        <li>After authorization, the account data can be synced to Google Drive</li>
      </ol>
    </div>

    <!-- Connected Accounts Status -->
    <div id="connectedAccountsSection" class="status-card">
      <h3>üìä Connected Accounts</h3>
      <div id="accountsList" class="account-list">
        <p style="color: #666;">No accounts connected yet.</p>
      </div>
      <div id="syncStatus" class="sync-status hidden">
        <strong>Last Sync:</strong> <span id="lastSyncTime">Never</span><br>
        <strong>Next Sync:</strong> <span id="nextSyncTime">-</span>
      </div>
    </div>

    <!-- Login Section -->
    <div class="login-section">
      <h3>‚ûï Add Instagram Account</h3>
      
      <p>Quick select from MoonMedia accounts:</p>
      <div class="suggested-accounts">
        <button class="suggested-btn" onclick="fillUsername('popdartsgame')">@popdartsgame</button>
        <button class="suggested-btn" onclick="fillUsername('bucketgolfgame')">@bucketgolfgame</button>
        <button class="suggested-btn" onclick="fillUsername('playbattlegolf')">@playbattlegolf</button>
        <button class="suggested-btn" onclick="fillUsername('flinggolf')">@flinggolf</button>
        <button class="suggested-btn" onclick="fillUsername('golfpong.games')">@golfpong.games</button>
        <button class="suggested-btn" onclick="fillUsername('discgogames')">@discgogames</button>
        <button class="suggested-btn" onclick="fillUsername('low_tide_golf')">@low_tide_golf</button>
      </div>
      
      <p style="margin-top: 1.5em;">Or add your own account:</p>
      <div class="suggested-accounts">
        <button class="suggested-btn" onclick="fillUsername('crespoworld')">@crespoworld</button>
      </div>

      <div style="margin-top: 1.5em;">
        <input type="text" id="usernameInput" placeholder="Instagram username" autocomplete="username">
      </div>
      
      <div style="margin-top: 1em;">
        <button class="instagram-btn" onclick="initiateInstagramLogin()">
          üì∏ Connect with Instagram
        </button>
      </div>
      
      <div class="warning-box" style="margin-top: 1.5em;">
        <strong>‚ö†Ô∏è How Instagram OAuth Works:</strong><br><br>
        When you click "Connect with Instagram", you'll be redirected to Instagram's official login page where you'll enter your username and password directly on Instagram's site (not here). 
        Instagram will then ask you to authorize this app to access your account data.<br><br>
        <strong>Requirements for Full Automation:</strong>
        <ul style="margin: 0.5em 0; padding-left: 1.5em;">
          <li>A Meta/Facebook Developer App with Instagram Basic Display API</li>
          <li>A backend server to handle token exchange and API calls</li>
          <li>Google Cloud credentials for Sheets API access</li>
        </ul>
        <em style="color: #888;">Currently using manual scraper mode - run <code>python scrapers/insta_scraper.py</code></em>
      </div>
    </div>

    <!-- OAuth Configuration Section (for developers) -->
    <div class="login-section">
      <h3>‚öôÔ∏è API Configuration</h3>
      <p style="color: #888; font-size: 0.9em;">
        For full automation, the following setup is required:
      </p>
      <div class="info-box">
        <strong>Current Setup:</strong><br>
        ‚Ä¢ Google Drive ID: <code>19PDIP7_YaluxsmvQsDJ89Bn5JkXnK2n2</code><br>
        ‚Ä¢ Scraper: <code>scrapers/insta_scraper.py</code><br>
        ‚Ä¢ Instagram App: <span id="appStatus" style="color: #ff0;">Not configured</span><br>
        ‚Ä¢ Backend API: <span id="backendStatus" style="color: #ff0;">Not configured</span><br>
        ‚Ä¢ Scraper Status: <span id="scraperStatus" style="color: #2ecc71;">Ready for manual use</span>
      </div>
      
      <div class="warning-box">
        <strong>üìã Why Automatic Updates Require a Backend:</strong><br><br>
        Instagram's OAuth flow returns an authorization code that must be exchanged for an access token. 
        This exchange requires your App Secret, which cannot be safely included in client-side JavaScript.<br><br>
        A backend server is needed to:
        <ol style="margin: 0.5em 0; padding-left: 1.5em;">
          <li>Securely exchange the code for an access token</li>
          <li>Store and refresh tokens before they expire</li>
          <li>Call Instagram's API to fetch account data</li>
          <li>Update the Google Drive spreadsheet via Google Sheets API</li>
        </ol>
        <em>Without a backend, use the manual Python scraper.</em>
      </div>
      
      <div id="manualScrapeSection" style="margin-top: 1.5em;">
        <p>Actions for connected accounts:</p>
        <button onclick="triggerManualScrape()">üîÑ Run Scraper Now</button>
        <button onclick="viewAnalytics()">üìä View Analytics</button>
      </div>
    </div>

    <!-- Session Info -->
    <div id="sessionInfo" class="status-card hidden">
      <h3>üîê Session Information</h3>
      <div id="sessionDetails">
        <p><strong>Status:</strong> <span class="status-indicator indicator-green"></span> Active</p>
        <p class="countdown">Session expires in: <span id="sessionCountdown">--:--:--</span></p>
        <p style="font-size: 0.85em; color: #888;">
          Instagram access tokens expire after 60 days. You'll need to re-authorize before expiry.
        </p>
      </div>
      <button onclick="refreshSession()">üîÑ Refresh Session</button>
      <button onclick="disconnectAll()" style="border-color: #e74c3c; color: #e74c3c;">üîì Disconnect All</button>
    </div>
  </div>

  <script>
    // Instagram OAuth Configuration
    // Uses Instagram Basic Display API for authentication
    // Users will be redirected to Instagram to log in and authorize access
    const INSTAGRAM_CONFIG = {
      // Instagram Basic Display API endpoint
      authEndpoint: 'https://api.instagram.com/oauth/authorize',
      // This would need to be your registered Instagram App ID from developers.facebook.com
      // For now, we'll redirect to Instagram login page directly
      clientId: 'YOUR_INSTAGRAM_APP_ID', // Replace with your actual App ID
      redirectUri: window.location.origin + '/instalogin.html',
      scope: 'user_profile,user_media',
      googleDriveSheetId: '19PDIP7_YaluxsmvQsDJ89Bn5JkXnK2n2',
      
      // Backend API endpoint that would handle token exchange and Google Drive sync
      // This would be needed for a fully automated solution
      backendApiUrl: null  // Set this to your backend API URL when available
    };

    // MoonMedia suggested accounts
    const MOONMEDIA_ACCOUNTS = [
      'popdartsgame',
      'bucketgolfgame', 
      'playbattlegolf',
      'flinggolf',
      'golfpong.games',
      'discgogames',
      'low_tide_golf'
    ];

    // State management
    let connectedAccounts = [];
    let sessionData = null;
    let countdownIntervalId = null;  // Track interval to prevent memory leaks

    // Initialize on page load
    document.addEventListener('DOMContentLoaded', function() {
      loadConnectedAccounts();
      checkOAuthCallback();
      updateUI();
    });

    // Fill username input with suggested account
    function fillUsername(username) {
      document.getElementById('usernameInput').value = username;
    }

    // Load connected accounts from localStorage with validation
    function loadConnectedAccounts() {
      try {
        const saved = localStorage.getItem('instagram_connected_accounts');
        if (saved) {
          const parsed = JSON.parse(saved);
          // Validate that parsed data is an array with expected structure
          if (Array.isArray(parsed)) {
            connectedAccounts = parsed.filter(account => 
              account && 
              typeof account.username === 'string' && 
              typeof account.expiresAt === 'string'
            );
          }
        }
        const session = localStorage.getItem('instagram_session');
        if (session) {
          const parsedSession = JSON.parse(session);
          // Validate session data structure
          if (parsedSession && typeof parsedSession === 'object') {
            sessionData = parsedSession;
          }
        }
      } catch (e) {
        console.error('Error loading saved data:', e);
        // Reset to defaults on error
        connectedAccounts = [];
        sessionData = null;
      }
    }

    // Save connected accounts to localStorage
    function saveConnectedAccounts() {
      localStorage.setItem('instagram_connected_accounts', JSON.stringify(connectedAccounts));
      if (sessionData) {
        localStorage.setItem('instagram_session', JSON.stringify(sessionData));
      }
    }

    // Update UI based on current state
    function updateUI() {
      const accountsList = document.getElementById('accountsList');
      const sessionInfo = document.getElementById('sessionInfo');
      const syncStatus = document.getElementById('syncStatus');

      if (connectedAccounts.length > 0) {
        let html = '';
        connectedAccounts.forEach(account => {
          const expiryDate = new Date(account.expiresAt);
          const daysLeft = Math.ceil((expiryDate - new Date()) / (1000 * 60 * 60 * 24));
          const expiryColor = daysLeft > 7 ? '#2ecc71' : (daysLeft > 0 ? '#ff0' : '#e74c3c');
          
          html += `
            <div class="account-item">
              <div>
                <span class="username">@${account.username}</span>
                <br>
                <span class="expiry" style="color: ${expiryColor}">
                  ${daysLeft > 0 ? `Expires in ${daysLeft} days` : 'Expired'}
                </span>
              </div>
              <button onclick="removeAccount('${account.username}')" style="padding: 0.3em 0.6em; font-size: 0.8em;">‚úï</button>
            </div>
          `;
        });
        accountsList.innerHTML = html;
        
        sessionInfo.classList.remove('hidden');
        syncStatus.classList.remove('hidden');
        
        // Update countdown
        startSessionCountdown();
        
        // Update sync times
        const lastSync = localStorage.getItem('instagram_last_sync');
        if (lastSync) {
          document.getElementById('lastSyncTime').textContent = new Date(parseInt(lastSync)).toLocaleString();
        }
        const nextSync = Date.now() + (24 * 60 * 60 * 1000); // 24 hours from now
        document.getElementById('nextSyncTime').textContent = new Date(nextSync).toLocaleString();
        
      } else {
        accountsList.innerHTML = '<p style="color: #666;">No accounts connected yet.</p>';
        sessionInfo.classList.add('hidden');
        syncStatus.classList.add('hidden');
      }
    }

    // Start session countdown timer
    function startSessionCountdown() {
      if (connectedAccounts.length === 0) return;
      
      // Clear any existing interval to prevent memory leaks
      if (countdownIntervalId) {
        clearInterval(countdownIntervalId);
        countdownIntervalId = null;
      }
      
      // Find the earliest expiry
      const earliestExpiry = Math.min(...connectedAccounts.map(a => new Date(a.expiresAt).getTime()));
      
      const updateCountdown = () => {
        const now = Date.now();
        const remaining = earliestExpiry - now;
        
        if (remaining <= 0) {
          document.getElementById('sessionCountdown').textContent = 'EXPIRED';
          document.getElementById('sessionCountdown').style.color = '#e74c3c';
          // Clear interval when expired
          if (countdownIntervalId) {
            clearInterval(countdownIntervalId);
            countdownIntervalId = null;
          }
          return;
        }
        
        const days = Math.floor(remaining / (1000 * 60 * 60 * 24));
        const hours = Math.floor((remaining % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        const minutes = Math.floor((remaining % (1000 * 60 * 60)) / (1000 * 60));
        
        document.getElementById('sessionCountdown').textContent = 
          `${days}d ${hours}h ${minutes}m`;
      };
      
      updateCountdown();
      countdownIntervalId = setInterval(updateCountdown, 60000); // Update every minute
    }

    // Initiate Instagram OAuth login
    function initiateInstagramLogin() {
      const username = document.getElementById('usernameInput').value.trim();
      
      if (!username) {
        alert('Please enter or select an Instagram username first.');
        return;
      }
      
      // Store the username we're trying to connect for when we return from OAuth
      localStorage.setItem('instagram_pending_username', username);
      
      // Check if a real Instagram App ID is configured
      if (INSTAGRAM_CONFIG.clientId === 'YOUR_INSTAGRAM_APP_ID') {
        // No real App ID configured - show setup instructions
        showSetupInstructions(username);
        return;
      }
      
      // Redirect to Instagram OAuth authorization page
      // This will require the user to log in with their Instagram credentials
      const authUrl = `${INSTAGRAM_CONFIG.authEndpoint}?` +
        `client_id=${INSTAGRAM_CONFIG.clientId}&` +
        `redirect_uri=${encodeURIComponent(INSTAGRAM_CONFIG.redirectUri)}&` +
        `scope=${INSTAGRAM_CONFIG.scope}&` +
        `response_type=code`;
      
      window.location.href = authUrl;
    }
    
    // Show setup instructions when Instagram App is not configured
    function showSetupInstructions(username) {
      const message = `üìã Instagram API Setup Required

To enable full Instagram OAuth login, you need to:

1Ô∏è‚É£ Create a Meta/Facebook Developer App:
   ‚Ä¢ Go to developers.facebook.com
   ‚Ä¢ Create a new app and add "Instagram Basic Display" product
   ‚Ä¢ Configure OAuth redirect URI to: ${INSTAGRAM_CONFIG.redirectUri}

2Ô∏è‚É£ Get your App ID and replace 'YOUR_INSTAGRAM_APP_ID' in instalogin.html

3Ô∏è‚É£ For automatic Google Drive sync, you'll need a backend server that:
   ‚Ä¢ Exchanges the OAuth code for an access token
   ‚Ä¢ Uses the Instagram API to fetch account data
   ‚Ä¢ Updates the Google Drive spreadsheet via Google Sheets API

üìù Current Workaround:
For now, you can run the Python scraper manually:
   cd scrapers
   python insta_scraper.py

Would you like to add @${username} to the pending accounts list for manual scraping?`;

      if (confirm(message)) {
        addPendingAccount(username);
      }
    }
    
    // Add account to pending list for manual scraping
    function addPendingAccount(username) {
      // Check if already connected
      if (connectedAccounts.some(a => a.username === username)) {
        alert(`@${username} is already in the accounts list!`);
        return;
      }
      
      // Add to connected accounts with 60-day expiry
      const expiresAt = new Date();
      expiresAt.setDate(expiresAt.getDate() + 60);
      
      connectedAccounts.push({
        username: username,
        connectedAt: new Date().toISOString(),
        expiresAt: expiresAt.toISOString(),
        status: 'pending_oauth'  // Indicates OAuth setup is needed
      });
      
      saveConnectedAccounts();
      updateUI();
      
      // Clear input
      document.getElementById('usernameInput').value = '';
      
      alert(`‚úÖ @${username} added to accounts list!\n\nTo sync data, run the Python scraper manually:\n  cd scrapers\n  python insta_scraper.py`);
    }

    // Check for OAuth callback
    function checkOAuthCallback() {
      const urlParams = new URLSearchParams(window.location.search);
      const code = urlParams.get('code');
      const error = urlParams.get('error');
      const errorReason = urlParams.get('error_reason');
      
      if (error) {
        // Handle OAuth error
        alert(`Instagram login failed: ${errorReason || error}\n\nPlease try again.`);
        window.history.replaceState({}, document.title, window.location.pathname);
        return;
      }
      
      if (code) {
        // Handle OAuth callback - we have an authorization code
        const pendingUsername = localStorage.getItem('instagram_pending_username');
        
        if (pendingUsername) {
          // In a full implementation, we would:
          // 1. Send this code to a backend server
          // 2. Exchange it for an access token
          // 3. Use the token to fetch Instagram data
          // 4. Update the Google Drive spreadsheet
          
          if (INSTAGRAM_CONFIG.backendApiUrl) {
            // Send to backend for token exchange
            exchangeCodeForToken(code, pendingUsername);
          } else {
            // No backend configured - show manual steps
            showBackendRequiredMessage(code, pendingUsername);
          }
          
          localStorage.removeItem('instagram_pending_username');
        }
        
        // Clean up URL
        window.history.replaceState({}, document.title, window.location.pathname);
      }
    }
    
    // Exchange authorization code for access token via backend
    async function exchangeCodeForToken(code, username) {
      try {
        const response = await fetch(`${INSTAGRAM_CONFIG.backendApiUrl}/auth/instagram/callback`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({
            code: code,
            username: username,
            redirectUri: INSTAGRAM_CONFIG.redirectUri
          })
        });
        
        if (!response.ok) {
          throw new Error('Token exchange failed');
        }
        
        const data = await response.json();
        
        // Add the successfully authenticated account
        const expiresAt = new Date();
        expiresAt.setDate(expiresAt.getDate() + 60);
        
        connectedAccounts.push({
          username: username,
          connectedAt: new Date().toISOString(),
          expiresAt: expiresAt.toISOString(),
          status: 'connected'
          // Note: Access token is stored securely on the backend server
          // Never store access tokens in client-side localStorage
        });
        
        saveConnectedAccounts();
        updateUI();
        
        alert(`‚úÖ Successfully connected @${username}!\n\nYour reels data will automatically sync to the Google Drive spreadsheet.`);
        
      } catch (error) {
        console.error('Token exchange error:', error);
        alert(`Failed to complete authentication: ${error.message}\n\nPlease try again.`);
      }
    }
    
    // Show message when backend is required but not configured
    function showBackendRequiredMessage(code, username) {
      const message = `‚úÖ Instagram Authorization Successful!

You've authorized access to @${username}'s Instagram account.

‚ö†Ô∏è Backend Server Required:
To complete the setup and enable automatic Google Drive sync, a backend server is needed to:

1. Exchange the authorization code for an access token
2. Periodically fetch Instagram data using the API
3. Update the Google Drive spreadsheet

üìù For now, the account has been added to your list.
Run the Python scraper manually to sync data:
   cd scrapers
   python insta_scraper.py`;

      alert(message);
      
      // Add to pending accounts
      addPendingAccount(username);
    }

    // Remove an account
    function removeAccount(username) {
      if (confirm(`Disconnect @${username}?`)) {
        connectedAccounts = connectedAccounts.filter(a => a.username !== username);
        saveConnectedAccounts();
        updateUI();
      }
    }

    // Refresh session
    function refreshSession() {
      alert('To refresh your session, disconnect and reconnect your accounts.\n\nInstagram access tokens are valid for 60 days.');
    }

    // Disconnect all accounts
    function disconnectAll() {
      if (confirm('Disconnect all Instagram accounts?')) {
        connectedAccounts = [];
        sessionData = null;
        localStorage.removeItem('instagram_connected_accounts');
        localStorage.removeItem('instagram_session');
        updateUI();
      }
    }

    // Trigger manual scrape
    function triggerManualScrape() {
      if (connectedAccounts.length === 0) {
        alert('Please connect at least one Instagram account first.');
        return;
      }
      
      const accountsToScrape = connectedAccounts.map(a => a.username).join(', ');
      
      alert(`üîÑ Manual Scrape Initiated\n\nAccounts: ${accountsToScrape}\n\nTo run the scraper:\n1. Open terminal\n2. Navigate to scrapers folder\n3. Run: python insta_scraper.py\n\nThe data will automatically upload to Google Drive.`);
      
      // Update last sync time
      localStorage.setItem('instagram_last_sync', Date.now().toString());
      updateUI();
    }

    // View analytics
    function viewAnalytics() {
      window.location.href = 'crespomize.html';
    }
  </script>
</body>
</html>
